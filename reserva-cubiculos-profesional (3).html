<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Reserva - Biblioteca UCSG</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* ========================================
           VARIABLES CSS PARA CONSISTENCIA
        ======================================== */
        :root {
            --primary-color: #C41E3A;
            --primary-dark: #8B0000;
            --primary-light: #DC143C;
            --secondary-color: #FF4444;
            --success-color: #28A745;
            --success-light: #D4EDDA;
            --danger-color: #DC3545;
            --danger-light: #F8D7DA;
            --warning-color: #FFC107;
            --gray-100: #F8F9FA;
            --gray-200: #E9ECEF;
            --gray-300: #DEE2E6;
            --gray-400: #CED4DA;
            --gray-500: #ADB5BD;
            --gray-600: #6C757D;
            --gray-700: #495057;
            --gray-800: #343A40;
            --gray-900: #212529;
            --white: #FFFFFF;
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.15);
            --shadow-xl: 0 20px 60px rgba(0, 0, 0, 0.2);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ========================================
           RESET Y ESTILOS GENERALES
        ======================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 50%, var(--primary-light) 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Patr√≥n de fondo decorativo */
        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(255, 255, 255, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 255, 255, 0.05) 0%, transparent 50%);
            pointer-events: none;
        }

        /* ========================================
           CONTENEDOR PRINCIPAL
        ======================================== */
        .container {
            background: var(--white);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-xl);
            max-width: 1000px;
            width: 100%;
            overflow: hidden;
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 1;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ========================================
           HEADER INSTITUCIONAL
        ======================================== */
        .header {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary-color) 100%);
            color: var(--white);
            padding: 40px 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 300px;
            height: 300px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -30%;
            left: -5%;
            width: 200px;
            height: 200px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 50%;
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .logo-container {
            margin-bottom: 15px;
        }

        .logo-icon {
            font-size: 48px;
            display: inline-block;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.95;
            font-weight: 400;
            letter-spacing: 0.3px;
        }

        /* ========================================
           BARRA DE PROGRESO
        ======================================== */
        .progress-bar {
            background: var(--gray-200);
            height: 4px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--secondary-color), var(--primary-light));
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* ========================================
           CONTENIDO DE PANTALLAS
        ======================================== */
        .screen {
            display: none;
            padding: 50px 40px;
            min-height: 500px;
            animation: slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .screen.active {
            display: block;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* ========================================
           PANTALLA DE BIENVENIDA
        ======================================== */
        .welcome-screen {
            text-align: center;
        }

        .welcome-icon {
            font-size: 100px;
            margin-bottom: 30px;
            display: inline-block;
            animation: scaleIn 0.6s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .welcome-screen h2 {
            color: var(--gray-900);
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 20px;
            letter-spacing: -0.5px;
        }

        .welcome-screen p {
            color: var(--gray-600);
            font-size: 18px;
            line-height: 1.8;
            margin-bottom: 40px;
            max-width: 650px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
        }

        .feature-card {
            background: var(--gray-100);
            padding: 25px;
            border-radius: var(--border-radius);
            transition: var(--transition);
            border: 2px solid transparent;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-light);
        }

        .feature-icon {
            font-size: 40px;
            margin-bottom: 15px;
        }

        .feature-card h3 {
            color: var(--gray-800);
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .feature-card p {
            color: var(--gray-600);
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
        }

        /* ========================================
           BOTONES
        ======================================== */
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-light));
            color: var(--white);
            border: none;
            padding: 16px 40px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            font-family: 'Inter', sans-serif;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--gray-600);
            box-shadow: var(--shadow-sm);
        }

        .btn-secondary:hover {
            background: var(--gray-700);
        }

        .btn-small {
            padding: 10px 24px;
            font-size: 14px;
            border-radius: 6px;
        }

        .btn-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 30px;
        }

        /* ========================================
           TABLA DE CUB√çCULOS
        ======================================== */
        .availability-header {
            margin-bottom: 30px;
        }

        .availability-header h2 {
            color: var(--gray-900);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .availability-header p {
            color: var(--gray-600);
            font-size: 16px;
        }

        .filter-section {
            background: var(--gray-100);
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-section label {
            color: var(--gray-700);
            font-weight: 500;
            font-size: 14px;
        }

        .filter-select {
            padding: 10px 15px;
            border: 2px solid var(--gray-300);
            border-radius: 6px;
            font-size: 14px;
            background: var(--white);
            cursor: pointer;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
        }

        .filter-select:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .cubicle-table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
        }

        .cubicle-table {
            width: 100%;
            border-collapse: collapse;
            background: var(--white);
        }

        .cubicle-table thead {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-color));
            color: var(--white);
        }

        .cubicle-table th {
            padding: 18px 20px;
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 13px;
            letter-spacing: 0.8px;
        }

        .cubicle-table tbody tr {
            border-bottom: 1px solid var(--gray-200);
            transition: var(--transition);
        }

        .cubicle-table tbody tr:hover {
            background: var(--gray-100);
        }

        .cubicle-table tbody tr:last-child {
            border-bottom: none;
        }

        .cubicle-table td {
            padding: 20px;
            font-size: 15px;
            color: var(--gray-700);
        }

        .cubicle-id {
            font-weight: 700;
            color: var(--primary-color);
            font-size: 18px;
        }

        .cubicle-capacity {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .capacity-icon {
            font-size: 18px;
        }

        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .status::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
        }

        .status.disponible {
            background: var(--success-light);
            color: #155724;
        }

        .status.disponible::before {
            background: var(--success-color);
            animation: pulse 2s infinite;
        }

        .status.ocupado {
            background: var(--danger-light);
            color: #721C24;
        }

        .status.ocupado::before {
            background: var(--danger-color);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes pulse-button {
            0%, 100% {
                box-shadow: 0 4px 6px rgba(196, 30, 58, 0.3);
            }
            50% {
                box-shadow: 0 6px 20px rgba(196, 30, 58, 0.5);
            }
        }

        @keyframes rotate {
            from {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        /* ========================================
           FORMULARIO DE RESERVA
        ======================================== */
        .form-header {
            margin-bottom: 30px;
        }

        .form-header h2 {
            color: var(--gray-900);
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .selected-cubicle {
            background: linear-gradient(135deg, #E7F3FF 0%, #F0F8FF 100%);
            border-left: 4px solid var(--primary-color);
            padding: 25px;
            margin-bottom: 35px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        .selected-cubicle h3 {
            color: var(--primary-dark);
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .selected-cubicle-icon {
            font-size: 24px;
        }

        .cubicle-details {
            display: flex;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .cubicle-detail-item {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray-700);
            font-size: 15px;
        }

        .cubicle-detail-item strong {
            color: var(--primary-color);
        }

        .form-section {
            background: var(--gray-100);
            padding: 30px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
        }

        .form-section-title {
            color: var(--gray-800);
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            color: var(--gray-800);
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 14px;
            letter-spacing: 0.3px;
        }

        .required-mark {
            color: var(--danger-color);
            margin-left: 3px;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-300);
            border-radius: 8px;
            font-size: 15px;
            transition: var(--transition);
            font-family: 'Inter', sans-serif;
            background: var(--white);
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 82, 163, 0.1);
        }

        .form-group input::placeholder {
            color: var(--gray-400);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .input-icon {
            position: relative;
        }

        .input-icon input {
            padding-left: 45px;
        }

        .input-icon::before {
            content: attr(data-icon);
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            color: var(--gray-400);
            pointer-events: none;
        }

        .help-text {
            font-size: 13px;
            color: var(--gray-600);
            margin-top: 6px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .error-message {
            color: var(--danger-color);
            font-size: 13px;
            margin-top: 6px;
            display: none;
            align-items: center;
            gap: 5px;
        }

        .form-group.error input,
        .form-group.error select {
            border-color: var(--danger-color);
        }

        .form-group.error .error-message {
            display: flex;
        }

        /* ========================================
           PANTALLA DE CONFIRMACI√ìN
        ======================================== */
        .confirmation-screen {
            text-align: center;
        }

        .success-animation {
            width: 120px;
            height: 120px;
            margin: 0 auto 30px;
            background: linear-gradient(135deg, var(--success-color), #20C997);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: successPop 0.6s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 40px rgba(40, 167, 69, 0.3);
        }

        @keyframes successPop {
            0% {
                opacity: 0;
                transform: scale(0);
            }
            50% {
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .success-icon {
            font-size: 60px;
            color: var(--white);
        }

        .confirmation-screen h2 {
            color: var(--success-color);
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .confirmation-screen > p {
            color: var(--gray-600);
            font-size: 18px;
            margin-bottom: 40px;
        }

        .reservation-card {
            background: var(--white);
            border: 2px solid var(--gray-200);
            border-radius: var(--border-radius);
            padding: 35px;
            margin: 30px auto;
            max-width: 600px;
            text-align: left;
            box-shadow: var(--shadow-md);
        }

        .reservation-card-header {
            border-bottom: 2px solid var(--gray-200);
            padding-bottom: 20px;
            margin-bottom: 25px;
        }

        .reservation-card-header h3 {
            color: var(--gray-900);
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .reservation-number {
            color: var(--gray-600);
            font-size: 14px;
            font-family: 'Courier New', monospace;
        }

        .reservation-details {
            display: grid;
            gap: 18px;
        }

        .detail-row {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 12px;
            background: var(--gray-100);
            border-radius: 8px;
            transition: var(--transition);
        }

        .detail-row:hover {
            background: var(--gray-200);
        }

        .detail-icon {
            font-size: 22px;
            color: var(--primary-color);
            min-width: 30px;
            text-align: center;
        }

        .detail-content {
            flex: 1;
        }

        .detail-label {
            font-size: 13px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
            font-weight: 600;
        }

        .detail-value {
            font-size: 16px;
            color: var(--gray-900);
            font-weight: 500;
        }

        .important-notice {
            background: linear-gradient(135deg, #FFF3CD, #FFF8E1);
            border-left: 4px solid var(--warning-color);
            padding: 20px;
            border-radius: var(--border-radius);
            margin: 30px auto;
            max-width: 600px;
        }

        .important-notice h4 {
            color: #856404;
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .important-notice p {
            color: #856404;
            font-size: 14px;
            line-height: 1.6;
            margin: 0;
        }

        /* ========================================
           LOADING SPINNER
        ======================================== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-top-color: var(--white);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ========================================
           NOTIFICACIONES TOAST
        ======================================== */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            max-width: 350px;
        }

        .toast {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: flex-start;
            gap: 15px;
            animation: slideInRight 0.3s ease-out;
            border-left: 4px solid;
        }

        .toast.success { border-left-color: var(--success-color); }
        .toast.error { border-left-color: var(--danger-color); }
        .toast.warning { border-left-color: var(--warning-color); }

        @keyframes slideInRight {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast-icon {
            font-size: 24px;
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-weight: 700;
            font-size: 15px;
            margin-bottom: 5px;
            color: var(--gray-900);
        }

        .toast-message {
            font-size: 14px;
            color: var(--gray-600);
        }

        /* ========================================
           RESPONSIVE
        ======================================== */
        @media (max-width: 768px) {
            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 24px;
            }

            .header p {
                font-size: 14px;
            }

            .screen {
                padding: 30px 20px;
                min-height: auto;
            }

            .welcome-screen h2,
            .confirmation-screen h2 {
                font-size: 28px;
            }

            .welcome-icon {
                font-size: 80px;
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
                width: 100%;
            }

            .btn {
                width: 100%;
            }

            .cubicle-table th,
            .cubicle-table td {
                padding: 12px 10px;
                font-size: 13px;
            }

            .cubicle-id {
                font-size: 16px;
            }

            .filter-section {
                flex-direction: column;
                align-items: stretch;
            }

            .filter-select {
                width: 100%;
            }

            .cubicle-details {
                flex-direction: column;
                gap: 15px;
            }

            .form-section {
                padding: 20px;
            }

            .reservation-card {
                padding: 25px 20px;
            }

            .toast-container {
                left: 20px;
                right: 20px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .container {
                border-radius: 8px;
            }

            .logo-icon {
                font-size: 36px;
            }

            .header h1 {
                font-size: 20px;
            }

            .screen {
                padding: 20px 15px;
            }

            .btn {
                padding: 14px 30px;
                font-size: 14px;
            }
        }

        /* ========================================
           UTILIDADES
        ======================================== */
        .text-center {
            text-align: center;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        .mb-30 {
            margin-bottom: 30px;
        }

        .mt-30 {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <!-- ========================================
         OVERLAY DE CARGA
    ======================================== -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <!-- ========================================
         MODAL DE CONFIRMACI√ìN
    ======================================== -->
    <div class="loading-overlay" id="confirmModal" style="background: rgba(0, 0, 0, 0.8);">
        <div style="background: white; padding: 40px; border-radius: 15px; max-width: 500px; width: 90%; text-align: center; animation: scaleIn 0.3s ease-out;">
            <div style="font-size: 60px; margin-bottom: 20px;">‚ö†Ô∏è</div>
            <h2 style="color: var(--gray-900); margin-bottom: 15px; font-size: 24px;">¬øConfirmar Reserva?</h2>
            <p style="color: var(--gray-600); margin-bottom: 30px; line-height: 1.6;">
                Est√°s a punto de confirmar tu reserva. Por favor verifica que todos los datos sean correctos antes de continuar.
            </p>
            <div id="confirmModalDetails" style="background: var(--gray-100); padding: 20px; border-radius: 10px; margin-bottom: 25px; text-align: left; font-size: 14px;">
                <!-- Detalles din√°micos -->
            </div>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <button class="btn" onclick="confirmReservation()" style="background: var(--success-color);">
                    ‚úì S√≠, Confirmar
                </button>
                <button class="btn btn-secondary" onclick="closeConfirmModal()">
                    ‚úï Cancelar
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         CONTENEDOR DE NOTIFICACIONES
    ======================================== -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- ========================================
         CONTENEDOR PRINCIPAL
    ======================================== -->
    <div class="container">
        <!-- ========================================
             HEADER INSTITUCIONAL
        ======================================== -->
        <div class="header">
            <div class="header-content">
                <div class="logo-container">
                    <div class="logo-icon">üìö</div>
                </div>
                <h1>Universidad Cat√≥lica de Santiago de Guayaquil</h1>
                <p>Sistema de Reserva de Cub√≠culos - Biblioteca Central</p>
            </div>
        </div>

        <!-- Barra de progreso -->
        <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
        </div>

        <!-- ========================================
             PANTALLA 1: BIENVENIDA
        ======================================== -->
        <div id="welcomeScreen" class="screen active">
            <div class="welcome-screen">
                <div class="welcome-icon">üéì</div>
                <h2>Bienvenido al Sistema de Reservas</h2>
                <p>
                    Reserva tu espacio de estudio de manera r√°pida, f√°cil y segura. 
                    Nuestros cub√≠culos est√°n dise√±ados para brindarte un ambiente 
                    √≥ptimo para tus sesiones de estudio individual o en grupo.
                </p>

                <!-- Caracter√≠sticas del sistema -->
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">‚ö°</div>
                        <h3>Reserva R√°pida</h3>
                        <p>Proceso simple en 3 pasos</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">üìÖ</div>
                        <h3>Disponibilidad</h3>
                        <p>Consulta en tiempo real</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">‚úÖ</div>
                        <h3>Confirmaci√≥n</h3>
                        <p>Inmediata y segura</p>
                    </div>
                </div>

                <button class="btn" onclick="navigateToScreen('availabilityScreen', 33)">
                    Comenzar Reserva
                </button>
            </div>
        </div>

        <!-- ========================================
             PANTALLA 2: DISPONIBILIDAD
        ======================================== -->
        <div id="availabilityScreen" class="screen">
            <div class="availability-header">
                <h2>Cub√≠culos Disponibles</h2>
                <p>Selecciona el cub√≠culo que mejor se adapte a tus necesidades</p>
            </div>

            <!-- Filtros -->
            <div class="filter-section">
                <label for="filterCapacity">Filtrar por capacidad:</label>
                <select id="filterCapacity" class="filter-select" onchange="filterCubicles()">
                    <option value="all">Todas las capacidades</option>
                    <option value="2">2 personas</option>
                    <option value="3">3 personas</option>
                    <option value="4">4 personas</option>
                    <option value="6">6 personas</option>
                </select>

                <label for="filterStatus">Estado:</label>
                <select id="filterStatus" class="filter-select" onchange="filterCubicles()">
                    <option value="all">Todos los estados</option>
                    <option value="disponible">Solo disponibles</option>
                    <option value="ocupado">Solo ocupados</option>
                </select>
            </div>

            <!-- Tabla de cub√≠culos -->
            <div class="cubicle-table-container">
                <table class="cubicle-table">
                    <thead>
                        <tr>
                            <th>Cub√≠culo</th>
                            <th>Capacidad</th>
                            <th>Equipamiento</th>
                            <th>Estado</th>
                            <th>Acci√≥n</th>
                        </tr>
                    </thead>
                    <tbody id="cubicleTableBody">
                        <!-- Generado din√°micamente -->
                    </tbody>
                </table>
            </div>

            <div class="btn-group mt-30">
                <button class="btn btn-secondary" onclick="navigateToScreen('welcomeScreen', 0)">
                    ‚Üê Volver
                </button>
            </div>
        </div>

        <!-- ========================================
             PANTALLA 3: FORMULARIO DE RESERVA
        ======================================== -->
        <div id="reservationScreen" class="screen">
            <div class="form-header">
                <h2>Formulario de Reserva</h2>
            </div>

            <!-- Informaci√≥n del cub√≠culo seleccionado -->
            <div class="selected-cubicle" id="selectedCubicleInfo">
                <!-- Generado din√°micamente -->
            </div>

            <form id="reservationForm" onsubmit="submitReservation(event)" novalidate>
                <!-- Secci√≥n: Datos del estudiante -->
                <div class="form-section">
                    <div class="form-section-title">
                        <span>üë§</span>
                        Datos del Estudiante
                    </div>

                    <div class="form-group">
                        <label for="studentName">
                            Nombre Completo
                            <span class="required-mark">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="studentName" 
                            required
                            placeholder="Ingresa tu nombre completo"
                            autocomplete="name"
                        >
                        <div class="error-message">‚ö†Ô∏è Por favor ingresa tu nombre completo</div>
                    </div>

                    <div class="form-group">
                        <label for="studentCode">
                            C√≥digo Universitario
                            <span class="required-mark">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="studentCode" 
                            required
                            placeholder="Formato: 2020-1234"
                            pattern="[0-9]{4}-[0-9]{4}"
                            maxlength="9"
                        >
                        <div class="help-text">
                            ‚ÑπÔ∏è Formato: YYYY-NNNN (Ejemplo: 2024-5678)
                        </div>
                        <div class="error-message">‚ö†Ô∏è Formato inv√°lido. Usa: YYYY-NNNN</div>
                    </div>

                    <div class="form-group">
                        <label for="studentEmail">
                            Correo Electr√≥nico
                            <span class="required-mark">*</span>
                        </label>
                        <input 
                            type="email" 
                            id="studentEmail" 
                            required
                            placeholder="tucorreo@est.ucsg.edu.ec"
                            autocomplete="email"
                        >
                        <div class="error-message">‚ö†Ô∏è Ingresa un correo electr√≥nico v√°lido</div>
                    </div>
                </div>

                <!-- Secci√≥n: Detalles de la reserva -->
                <div class="form-section">
                    <div class="form-section-title">
                        <span>üìÖ</span>
                        Detalles de la Reserva
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="reservationDate">
                                Fecha de Reserva
                                <span class="required-mark">*</span>
                            </label>
                            <input 
                                type="date" 
                                id="reservationDate" 
                                required
                            >
                            <div class="error-message">‚ö†Ô∏è Selecciona una fecha v√°lida</div>
                        </div>

                        <div class="form-group">
                            <label for="numPeople">
                                N√∫mero de Personas
                                <span class="required-mark">*</span>
                            </label>
                            <input 
                                type="number" 
                                id="numPeople" 
                                min="1" 
                                max="6" 
                                required
                                placeholder="1"
                            >
                            <div class="help-text" id="capacityHelp">
                                ‚ÑπÔ∏è Capacidad m√°xima: <span id="maxCapacity">6</span> personas
                            </div>
                            <div class="error-message">‚ö†Ô∏è El n√∫mero debe estar entre 1 y <span id="maxCapacityError">6</span></div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="startTime">
                                Hora de Inicio
                                <span class="required-mark">*</span>
                            </label>
                            <input 
                                type="time" 
                                id="startTime" 
                                required
                                min="07:00"
                                max="20:00"
                            >
                            <div class="help-text">‚è∞ Horario: 07:00 - 21:00</div>
                            <div class="error-message">‚ö†Ô∏è Selecciona una hora de inicio</div>
                        </div>

                        <div class="form-group">
                            <label for="endTime">
                                Hora de Fin
                                <span class="required-mark">*</span>
                            </label>
                            <input 
                                type="time" 
                                id="endTime" 
                                required
                                min="07:00"
                                max="21:00"
                            >
                            <div class="help-text">‚è∞ Horario: 07:00 - 21:00</div>
                            <div class="error-message">‚ö†Ô∏è La hora de fin debe ser posterior a la de inicio</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="purpose">
                            Prop√≥sito de la Reserva
                            <span class="required-mark">*</span>
                        </label>
                        <select id="purpose" required class="filter-select">
                            <option value="">Selecciona una opci√≥n</option>
                            <option value="estudio-individual">Estudio Individual</option>
                            <option value="estudio-grupal">Estudio Grupal</option>
                            <option value="proyecto">Trabajo en Proyecto</option>
                            <option value="investigacion">Investigaci√≥n</option>
                            <option value="tutorias">Tutor√≠as</option>
                            <option value="otro">Otro</option>
                        </select>
                        <div class="error-message">‚ö†Ô∏è Selecciona el prop√≥sito de tu reserva</div>
                    </div>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn" style="font-size: 18px; padding: 18px 50px; animation: pulse-button 2s infinite;">
                        ‚úì CONFIRMAR RESERVA
                    </button>
                    <button 
                        type="button" 
                        class="btn btn-secondary" 
                        onclick="navigateToScreen('availabilityScreen', 33)"
                    >
                        ‚Üê Volver
                    </button>
                </div>
            </form>
        </div>

        <!-- ========================================
             PANTALLA 4: CONFIRMACI√ìN
        ======================================== -->
        <div id="confirmationScreen" class="screen">
            <div class="confirmation-screen">
                <!-- Animaci√≥n de √©xito mejorada -->
                <div style="position: relative; margin-bottom: 40px;">
                    <div class="success-animation">
                        <div class="success-icon">‚úì</div>
                    </div>
                    <!-- Confeti decorativo -->
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 100px; opacity: 0.1; animation: rotate 20s linear infinite;">
                        üéâ
                    </div>
                </div>

                <h2 style="font-size: 42px; margin-bottom: 10px; background: linear-gradient(135deg, var(--success-color), #20C997); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
                    ¬°Reserva Confirmada!
                </h2>
                
                <p style="color: var(--gray-600); font-size: 20px; margin-bottom: 15px; font-weight: 500;">
                    ‚ú® Tu cub√≠culo ha sido reservado exitosamente ‚ú®
                </p>

                <!-- Mensaje adicional destacado -->
                <div style="background: linear-gradient(135deg, #e8f5e9, #f1f8e9); border: 2px solid var(--success-color); border-radius: 15px; padding: 20px; margin: 30px auto; max-width: 600px; box-shadow: 0 5px 20px rgba(40, 167, 69, 0.2);">
                    <div style="font-size: 50px; margin-bottom: 10px;">üéì</div>
                    <h3 style="color: var(--success-color); font-size: 22px; font-weight: 700; margin-bottom: 10px;">
                        ¬°El cub√≠culo est√° reservado para ti!
                    </h3>
                    <p style="color: #2e7d32; font-size: 16px; line-height: 1.6; margin: 0;">
                        Hemos guardado tu reserva exitosamente. Puedes ver todos los detalles a continuaci√≥n.
                    </p>
                </div>

                <div class="reservation-card">
                    <div class="reservation-card-header">
                        <h3>Detalles de tu Reserva</h3>
                        <div class="reservation-number" id="reservationNumber"></div>
                    </div>
                    <div class="reservation-details" id="reservationDetails">
                        <!-- Generado din√°micamente -->
                    </div>
                </div>

                <div class="important-notice">
                    <h4>‚ö†Ô∏è Informaci√≥n Importante</h4>
                    <p>
                        Por favor, presenta tu c√≥digo universitario y un documento de identidad 
                        al llegar a la biblioteca. Recuerda llegar puntualmente para aprovechar 
                        todo el tiempo reservado. El cub√≠culo estar√° disponible durante el horario seleccionado.
                    </p>
                </div>

                <!-- Mensaje adicional de confirmaci√≥n -->
                <div style="background: linear-gradient(135deg, #fff3e0, #ffe0b2); border-left: 4px solid #ff9800; padding: 20px; border-radius: 10px; margin: 25px auto; max-width: 600px; text-align: left;">
                    <div style="display: flex; align-items: start; gap: 15px;">
                        <div style="font-size: 30px;">üìß</div>
                        <div>
                            <h4 style="color: #e65100; font-size: 16px; font-weight: 700; margin-bottom: 8px;">
                                Confirmaci√≥n Enviada
                            </h4>
                            <p style="color: #e65100; font-size: 14px; line-height: 1.6; margin: 0;" id="confirmationEmailMsg">
                                Se ha enviado una confirmaci√≥n a tu correo electr√≥nico con todos los detalles de tu reserva.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="btn-group" style="margin-top: 40px;">
                    <button class="btn" onclick="resetSystem()" style="font-size: 16px; padding: 16px 40px;">
                        üîÑ Hacer Nueva Reserva
                    </button>
                    <button class="btn btn-secondary" onclick="window.print()">
                        üñ®Ô∏è Imprimir Confirmaci√≥n
                    </button>
                    <button class="btn" onclick="downloadConfirmation()" style="background: linear-gradient(135deg, #FF6B6B, #EE5A6F);">
                        üì• Descargar PDF
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        /* ========================================
           CONFIGURACI√ìN Y DATOS GLOBALES
        ======================================== */
        
        // Base de datos simulada de cub√≠culos
        const cubicles = [
            { 
                id: 'C-01', 
                capacity: 4, 
                available: true,
                equipment: 'Pizarra, WiFi, Enchufes',
                floor: 2
            },
            { 
                id: 'C-02', 
                capacity: 6, 
                available: true,
                equipment: 'Proyector, Pizarra, WiFi',
                floor: 2
            },
            { 
                id: 'C-03', 
                capacity: 2, 
                available: false,
                equipment: 'WiFi, Enchufes',
                floor: 1
            },
            { 
                id: 'C-04', 
                capacity: 4, 
                available: true,
                equipment: 'Pizarra, WiFi, Monitor',
                floor: 3
            },
            { 
                id: 'C-05', 
                capacity: 3, 
                available: false,
                equipment: 'WiFi, Enchufes',
                floor: 1
            },
            { 
                id: 'C-06', 
                capacity: 6, 
                available: true,
                equipment: 'Proyector, Pizarra, WiFi',
                floor: 3
            },
            { 
                id: 'C-07', 
                capacity: 2, 
                available: true,
                equipment: 'WiFi, Enchufes, L√°mpara',
                floor: 2
            },
            { 
                id: 'C-08', 
                capacity: 4, 
                available: true,
                equipment: 'Pizarra, WiFi, Enchufes',
                floor: 1
            }
        ];

        // Estado global de la aplicaci√≥n
        let selectedCubicle = null;
        let reservationCounter = 1000;

        /* ========================================
           FUNCIONES DE NAVEGACI√ìN
        ======================================== */

        /**
         * Navega entre pantallas con animaci√≥n y actualizaci√≥n de progreso
         * @param {string} screenId - ID de la pantalla destino
         * @param {number} progress - Porcentaje de progreso (0-100)
         */
        function navigateToScreen(screenId, progress) {
            // Ocultar todas las pantallas
            const screens = document.querySelectorAll('.screen');
            screens.forEach(screen => screen.classList.remove('active'));

            // Mostrar la pantalla solicitada
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
            }

            // Actualizar barra de progreso
            updateProgress(progress);

            // Scroll al inicio
            window.scrollTo({ top: 0, behavior: 'smooth' });

            // Acciones espec√≠ficas por pantalla
            if (screenId === 'availabilityScreen') {
                generateCubicleTable();
            }
        }

        /**
         * Actualiza la barra de progreso
         * @param {number} percentage - Porcentaje (0-100)
         */
        function updateProgress(percentage) {
            const progressBar = document.getElementById('progressBar');
            if (progressBar) {
                progressBar.style.width = percentage + '%';
            }
        }

        /* ========================================
           FUNCIONES DE TABLA DE CUB√çCULOS
        ======================================== */

        /**
         * Genera la tabla de cub√≠culos disponibles
         */
        function generateCubicleTable() {
            const tableBody = document.getElementById('cubicleTableBody');
            tableBody.innerHTML = '';

            const capacityFilter = document.getElementById('filterCapacity').value;
            const statusFilter = document.getElementById('filterStatus').value;

            // Filtrar cub√≠culos
            const filteredCubicles = cubicles.filter(cubicle => {
                const capacityMatch = capacityFilter === 'all' || cubicle.capacity === parseInt(capacityFilter);
                const statusMatch = statusFilter === 'all' || 
                    (statusFilter === 'disponible' && cubicle.available) || 
                    (statusFilter === 'ocupado' && !cubicle.available);
                return capacityMatch && statusMatch;
            });

            if (filteredCubicles.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td colspan="5" style="text-align: center; padding: 40px; color: var(--gray-600);">
                        No se encontraron cub√≠culos con los filtros seleccionados
                    </td>
                `;
                tableBody.appendChild(row);
                return;
            }

            // Crear filas de la tabla
            filteredCubicles.forEach(cubicle => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>
                        <div class="cubicle-id">${cubicle.id}</div>
                        <div style="font-size: 12px; color: var(--gray-500); margin-top: 4px;">
                            Piso ${cubicle.floor}
                        </div>
                    </td>
                    <td>
                        <div class="cubicle-capacity">
                            <span class="capacity-icon">üë•</span>
                            <span>${cubicle.capacity} personas</span>
                        </div>
                    </td>
                    <td style="font-size: 14px; color: var(--gray-600);">
                        ${cubicle.equipment}
                    </td>
                    <td>
                        <span class="status ${cubicle.available ? 'disponible' : 'ocupado'}">
                            ${cubicle.available ? 'Disponible' : 'Ocupado'}
                        </span>
                    </td>
                    <td>
                        ${cubicle.available ? 
                            `<button class="btn btn-small" onclick="selectCubicle('${cubicle.id}')">
                                Reservar
                            </button>` : 
                            '<span style="color: var(--gray-500); font-size: 14px;">No disponible</span>'
                        }
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
        }

        /**
         * Filtra los cub√≠culos seg√∫n los criterios seleccionados
         */
        function filterCubicles() {
            generateCubicleTable();
        }

        /**
         * Selecciona un cub√≠culo para reservar
         * @param {string} cubicleId - ID del cub√≠culo seleccionado
         */
        function selectCubicle(cubicleId) {
            selectedCubicle = cubicles.find(c => c.id === cubicleId);
            
            if (!selectedCubicle) {
                showToast('error', 'Error', 'No se pudo seleccionar el cub√≠culo');
                return;
            }

            // Mostrar informaci√≥n del cub√≠culo seleccionado
            const cubicleInfo = document.getElementById('selectedCubicleInfo');
            cubicleInfo.innerHTML = `
                <h3>
                    <span class="selected-cubicle-icon">üìç</span>
                    Cub√≠culo ${selectedCubicle.id}
                </h3>
                <div class="cubicle-details">
                    <div class="cubicle-detail-item">
                        <span>üë•</span>
                        <strong>Capacidad:</strong> ${selectedCubicle.capacity} personas
                    </div>
                    <div class="cubicle-detail-item">
                        <span>üè¢</span>
                        <strong>Piso:</strong> ${selectedCubicle.floor}
                    </div>
                    <div class="cubicle-detail-item">
                        <span>üîß</span>
                        <strong>Equipamiento:</strong> ${selectedCubicle.equipment}
                    </div>
                </div>
            `;

            // Configurar validaciones del formulario
            setupFormValidations();

            // Navegar al formulario
            navigateToScreen('reservationScreen', 66);
            showToast('success', 'Cub√≠culo Seleccionado', `Has seleccionado el ${selectedCubicle.id}`);
        }

        /* ========================================
           CONFIGURACI√ìN Y VALIDACI√ìN DE FORMULARIO
        ======================================== */

        /**
         * Configura las validaciones y valores iniciales del formulario
         */
        function setupFormValidations() {
            // Establecer fecha m√≠nima (hoy) y m√°xima (30 d√≠as)
            const today = new Date();
            const minDate = today.toISOString().split('T')[0];
            const maxDate = new Date(today.setDate(today.getDate() + 30)).toISOString().split('T')[0];
            
            const dateInput = document.getElementById('reservationDate');
            dateInput.setAttribute('min', minDate);
            dateInput.setAttribute('max', maxDate);
            dateInput.value = minDate;

            // Configurar capacidad m√°xima
            const numPeopleInput = document.getElementById('numPeople');
            numPeopleInput.setAttribute('max', selectedCubicle.capacity);
            numPeopleInput.value = 1;
            
            document.getElementById('maxCapacity').textContent = selectedCubicle.capacity;
            document.getElementById('maxCapacityError').textContent = selectedCubicle.capacity;

            // Limpiar validaciones previas
            clearFormErrors();
        }

        /**
         * Limpia todos los errores del formulario
         */
        function clearFormErrors() {
            const formGroups = document.querySelectorAll('.form-group');
            formGroups.forEach(group => {
                group.classList.remove('error');
            });
        }

        /**
         * Valida un campo individual del formulario
         * @param {HTMLElement} input - Elemento input a validar
         * @returns {boolean} - true si es v√°lido
         */
        function validateField(input) {
            const formGroup = input.closest('.form-group');
            formGroup.classList.remove('error');

            // Validar campo requerido
            if (input.hasAttribute('required') && !input.value.trim()) {
                formGroup.classList.add('error');
                return false;
            }

            // Validar patr√≥n
            if (input.hasAttribute('pattern')) {
                const pattern = new RegExp(input.getAttribute('pattern'));
                if (!pattern.test(input.value)) {
                    formGroup.classList.add('error');
                    return false;
                }
            }

            // Validar email
            if (input.type === 'email') {
                const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailPattern.test(input.value)) {
                    formGroup.classList.add('error');
                    return false;
                }
            }

            // Validar n√∫mero de personas
            if (input.id === 'numPeople') {
                const value = parseInt(input.value);
                if (value < 1 || value > selectedCubicle.capacity) {
                    formGroup.classList.add('error');
                    return false;
                }
            }

            // Validar horas
            if (input.id === 'endTime') {
                const startTime = document.getElementById('startTime').value;
                const endTime = input.value;
                if (startTime && endTime && startTime >= endTime) {
                    formGroup.classList.add('error');
                    return false;
                }
            }

            return true;
        }

        /**
         * Valida todo el formulario
         * @returns {boolean} - true si todo es v√°lido
         */
        function validateForm() {
            const form = document.getElementById('reservationForm');
            const inputs = form.querySelectorAll('input[required], select[required]');
            let isValid = true;

            inputs.forEach(input => {
                if (!validateField(input)) {
                    isValid = false;
                }
            });

            return isValid;
        }

        // Agregar listeners de validaci√≥n en tiempo real
        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('reservationForm');
            if (form) {
                const inputs = form.querySelectorAll('input, select');
                inputs.forEach(input => {
                    input.addEventListener('blur', function() {
                        validateField(this);
                    });

                    input.addEventListener('input', function() {
                        if (this.closest('.form-group').classList.contains('error')) {
                            validateField(this);
                        }
                    });
                });
            }
        });

        /* ========================================
           ENV√çO Y PROCESAMIENTO DE RESERVA
        ======================================== */

        // Variable temporal para los datos del formulario
        let pendingReservation = null;

        /**
         * Procesa el env√≠o del formulario de reserva
         * @param {Event} event - Evento del formulario
         */
        function submitReservation(event) {
            event.preventDefault();

            // Validar formulario
            if (!validateForm()) {
                showToast('error', 'Error de Validaci√≥n', 'Por favor completa todos los campos correctamente');
                
                // Hacer scroll al primer error
                const firstError = document.querySelector('.form-group.error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return;
            }

            // Recopilar datos del formulario
            pendingReservation = {
                cubicle: selectedCubicle.id,
                cubicleCapacity: selectedCubicle.capacity,
                cubicleFloor: selectedCubicle.floor,
                cubicleEquipment: selectedCubicle.equipment,
                studentName: document.getElementById('studentName').value.trim(),
                studentCode: document.getElementById('studentCode').value.trim(),
                studentEmail: document.getElementById('studentEmail').value.trim(),
                date: document.getElementById('reservationDate').value,
                startTime: document.getElementById('startTime').value,
                endTime: document.getElementById('endTime').value,
                numPeople: document.getElementById('numPeople').value,
                purpose: document.getElementById('purpose').value,
                reservationNumber: generateReservationNumber(),
                timestamp: new Date().toISOString()
            };

            // Mostrar modal de confirmaci√≥n
            showConfirmModal(pendingReservation);
        }

        /**
         * Muestra el modal de confirmaci√≥n con los detalles de la reserva
         * @param {Object} data - Datos de la reserva
         */
        function showConfirmModal(data) {
            const modal = document.getElementById('confirmModal');
            const detailsDiv = document.getElementById('confirmModalDetails');

            // Formatear fecha
            const dateObj = new Date(data.date + 'T00:00:00');
            const formattedDate = dateObj.toLocaleDateString('es-EC', {
                weekday: 'long',
                day: 'numeric',
                month: 'long',
                year: 'numeric'
            });

            // Obtener el texto del prop√≥sito
            const purposeSelect = document.getElementById('purpose');
            const purposeText = purposeSelect.options[purposeSelect.selectedIndex].text;

            detailsDiv.innerHTML = `
                <div style="margin-bottom: 10px;"><strong>üìç Cub√≠culo:</strong> ${data.cubicle} (Piso ${data.cubicleFloor})</div>
                <div style="margin-bottom: 10px;"><strong>üë§ Estudiante:</strong> ${data.studentName}</div>
                <div style="margin-bottom: 10px;"><strong>üéì C√≥digo:</strong> ${data.studentCode}</div>
                <div style="margin-bottom: 10px;"><strong>üìÖ Fecha:</strong> ${formattedDate}</div>
                <div style="margin-bottom: 10px;"><strong>‚è∞ Horario:</strong> ${data.startTime} - ${data.endTime}</div>
                <div style="margin-bottom: 10px;"><strong>üë• Personas:</strong> ${data.numPeople}</div>
                <div><strong>üìù Prop√≥sito:</strong> ${purposeText}</div>
            `;

            modal.classList.add('active');
        }

        /**
         * Cierra el modal de confirmaci√≥n
         */
        function closeConfirmModal() {
            const modal = document.getElementById('confirmModal');
            modal.classList.remove('active');
            pendingReservation = null;
        }

        /**
         * Confirma y procesa la reserva
         */
        function confirmReservation() {
            if (!pendingReservation) return;

            // Cerrar modal
            closeConfirmModal();

            // Mostrar overlay de carga
            showLoading();

            const formData = pendingReservation;

            // Simular proceso de guardado (2 segundos)
            setTimeout(() => {
                // Marcar cub√≠culo como ocupado (simulaci√≥n)
                selectedCubicle.available = false;

                // Guardar en localStorage (simulaci√≥n de persistencia)
                saveReservation(formData);

                // Mostrar confirmaci√≥n
                displayConfirmation(formData);

                // Ocultar loading
                hideLoading();

                // Navegar a confirmaci√≥n
                navigateToScreen('confirmationScreen', 100);

                // Mostrar notificaci√≥n
                showToast('success', '¬°Reserva Confirmada!', 'Tu cub√≠culo ha sido reservado exitosamente');

                // Limpiar formulario
                document.getElementById('reservationForm').reset();
                clearFormErrors();

                // Limpiar datos pendientes
                pendingReservation = null;
            }, 2000);
        }

        /**
         * Genera un n√∫mero de reserva √∫nico
         * @returns {string} - N√∫mero de reserva
         */
        function generateReservationNumber() {
            reservationCounter++;
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            return `UCSG-${year}${month}-${reservationCounter}`;
        }

        /**
         * Guarda la reserva en localStorage
         * @param {Object} data - Datos de la reserva
         */
        function saveReservation(data) {
            try {
                let reservations = JSON.parse(localStorage.getItem('ucsg_reservations') || '[]');
                reservations.push(data);
                localStorage.setItem('ucsg_reservations', JSON.stringify(reservations));
                console.log('Reserva guardada exitosamente:', data);
            } catch (error) {
                console.error('Error al guardar reserva:', error);
            }
        }

        /**
         * Muestra los detalles de la confirmaci√≥n
         * @param {Object} data - Datos de la reserva
         */
        function displayConfirmation(data) {
            // Mostrar n√∫mero de reserva
            document.getElementById('reservationNumber').textContent = 
                `N¬∫ de Reserva: ${data.reservationNumber}`;

            // Formatear fecha
            const dateObj = new Date(data.date + 'T00:00:00');
            const formattedDate = dateObj.toLocaleDateString('es-EC', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Calcular duraci√≥n
            const start = data.startTime.split(':');
            const end = data.endTime.split(':');
            const durationMinutes = (parseInt(end[0]) * 60 + parseInt(end[1])) - 
                                   (parseInt(start[0]) * 60 + parseInt(start[1]));
            const hours = Math.floor(durationMinutes / 60);
            const minutes = durationMinutes % 60;
            const duration = hours > 0 ? 
                `${hours} hora${hours > 1 ? 's' : ''}${minutes > 0 ? ` ${minutes} min` : ''}` : 
                `${minutes} minutos`;

            // Obtener el texto del prop√≥sito
            const purposeSelect = document.getElementById('purpose');
            const purposeText = purposeSelect.options[purposeSelect.selectedIndex].text;

            // Generar HTML de detalles
            const detailsDiv = document.getElementById('reservationDetails');
            detailsDiv.innerHTML = `
                <div class="detail-row">
                    <div class="detail-icon">üìç</div>
                    <div class="detail-content">
                        <div class="detail-label">Cub√≠culo</div>
                        <div class="detail-value">${data.cubicle} - Piso ${data.cubicleFloor}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üë§</div>
                    <div class="detail-content">
                        <div class="detail-label">Estudiante</div>
                        <div class="detail-value">${data.studentName}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üéì</div>
                    <div class="detail-content">
                        <div class="detail-label">C√≥digo Universitario</div>
                        <div class="detail-value">${data.studentCode}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üìß</div>
                    <div class="detail-content">
                        <div class="detail-label">Correo Electr√≥nico</div>
                        <div class="detail-value">${data.studentEmail}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üìÖ</div>
                    <div class="detail-content">
                        <div class="detail-label">Fecha</div>
                        <div class="detail-value">${formattedDate}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">‚è∞</div>
                    <div class="detail-content">
                        <div class="detail-label">Horario</div>
                        <div class="detail-value">${data.startTime} - ${data.endTime} (${duration})</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üë•</div>
                    <div class="detail-content">
                        <div class="detail-label">N√∫mero de Personas</div>
                        <div class="detail-value">${data.numPeople} de ${data.cubicleCapacity}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üìù</div>
                    <div class="detail-content">
                        <div class="detail-label">Prop√≥sito</div>
                        <div class="detail-value">${purposeText}</div>
                    </div>
                </div>
                <div class="detail-row">
                    <div class="detail-icon">üîß</div>
                    <div class="detail-content">
                        <div class="detail-label">Equipamiento Disponible</div>
                        <div class="detail-value">${data.cubicleEquipment}</div>
                    </div>
                </div>
            `;

            // Actualizar mensaje de confirmaci√≥n de email
            const emailMsg = document.getElementById('confirmationEmailMsg');
            if (emailMsg) {
                emailMsg.textContent = `Se ha enviado una confirmaci√≥n a ${data.studentEmail} con todos los detalles de tu reserva.`;
            }
        }

        /* ========================================
           FUNCIONES DE UI
        ======================================== */

        /**
         * Muestra el overlay de carga
         */
        function showLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.add('active');
            }
        }

        /**
         * Oculta el overlay de carga
         */
        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.remove('active');
            }
        }

        /**
         * Muestra una notificaci√≥n toast
         * @param {string} type - Tipo de toast (success, error, warning)
         * @param {string} title - T√≠tulo de la notificaci√≥n
         * @param {string} message - Mensaje de la notificaci√≥n
         */
        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            if (!container) return;

            const icons = {
                success: '‚úì',
                error: '‚úï',
                warning: '‚ö†Ô∏è'
            };

            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <div class="toast-icon">${icons[type] || 'üîî'}</div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
            `;

            container.appendChild(toast);

            // Auto-eliminar despu√©s de 4 segundos
            setTimeout(() => {
                toast.style.animation = 'slideInRight 0.3s ease-out reverse';
                setTimeout(() => {
                    container.removeChild(toast);
                }, 300);
            }, 4000);
        }

        /**
         * Reinicia el sistema para una nueva reserva
         */
        function resetSystem() {
            selectedCubicle = null;
            document.getElementById('reservationForm').reset();
            clearFormErrors();
            navigateToScreen('welcomeScreen', 0);
            
            // Regenerar tabla para actualizar estados
            generateCubicleTable();
            
            showToast('success', 'Sistema Reiniciado', 'Puedes hacer una nueva reserva');
        }

        /**
         * Simula la descarga de la confirmaci√≥n en PDF
         */
        function downloadConfirmation() {
            showToast('success', 'Generando PDF', 'Tu confirmaci√≥n se est√° descargando...');
            
            // En un sistema real, aqu√≠ generar√≠as el PDF
            // Por ahora, simulamos la descarga
            setTimeout(() => {
                showToast('success', 'PDF Generado', 'La confirmaci√≥n ha sido descargada exitosamente');
            }, 1500);
        }

        /* ========================================
           INICIALIZACI√ìN
        ======================================== */

        /**
         * Inicializa la aplicaci√≥n cuando se carga la p√°gina
         */
        window.addEventListener('DOMContentLoaded', function() {
            console.log('Sistema de Reservas UCSG - Inicializado');
            
            // Generar tabla inicial
            generateCubicleTable();
            
            // Configurar fecha m√≠nima en el formulario
            const today = new Date().toISOString().split('T')[0];
            const dateInput = document.getElementById('reservationDate');
            if (dateInput) {
                dateInput.setAttribute('min', today);
            }

            // Mostrar mensaje de bienvenida
            setTimeout(() => {
                showToast('success', 'Bienvenido', 'Sistema de Reservas de Cub√≠culos UCSG');
            }, 500);
        });

        // Prevenir p√©rdida de datos al cerrar
        window.addEventListener('beforeunload', function(e) {
            if (selectedCubicle && document.getElementById('reservationScreen').classList.contains('active')) {
                const confirmationMessage = '¬øEst√°s seguro de que quieres salir? Los datos del formulario se perder√°n.';
                e.returnValue = confirmationMessage;
                return confirmationMessage;
            }
        });
    </script>
</body>
</html>
